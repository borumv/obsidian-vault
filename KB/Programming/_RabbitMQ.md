[RabbitMQ](https://www.rabbitmq.com/) – это [брокер сообщений](Брокер%20сообщений) с открытым исходным кодом. Он маршрутизирует собщения по всем базовым принципам протокола [[AMQP]] описанным в [спецификации](http://www.amqp.org/resources/download). Отправитель передает сообщение брокеру а тот доставляет его получателю. `RabbitMQ` реализует и дополняет протокол `AMQP`.

  

Основная идея модели обмена сообщениями в `RabbitMQ` заключается в том, что `producer` (издатель) не отправляет сообщения непосредственно в очередь. На самом деле и довольно часто издатель даже не знает, будет ли сообщение вообще доставлено в какую-либо очередь.

  

Вместо этого издатель может отправлять сообщения только на обмен. С одной стороны, обмен получает сообщения от издателей, а с другой — отправляет их в очереди. Обмен должен точно знать, что делать с полученным сообщением. Должно ли оно быть добавлено в определенную очередь? Должно ли оно быть добавлено в несколько очередей? Или сообщение нужно игнорировать.

  

![[Pasted image 20220625190923.png]]
  

Кратко работу `RabbitMQ` можно описать следующим образом:

  

1.  Издатель отправляет сообщение определенному обменнику
2.  Обменник, получив сообщение, маршрутизирует его в одну или несколько очередей в соответствии с правилами привязки между ним и очередью
3.  Очередь хранит ссылку на это сообщение. Само сообщение хранится в оперативной памяти или на диске
4.  Как только потребитель готов получить сообщение из очереди, сервер создает копию сообщения по ссылке и отправляет
5.  Потребитель получает сообщение и отправляет брокеру подтверждение
6.  Брокер, получив подтверждение, удаляет копию сообщения из очереди. Затем удаляет из оперативной памяти и с диска